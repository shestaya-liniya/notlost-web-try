{"version":3,"file":"src_global_helpers_payments_ts-src_hooks_useLayoutEffectWithPrevDeps_ts-src_util_directInputM-df920f.50cdacb7823c92a8223e.js","mappings":"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","sources":["webpack://telegram-t/./src/global/helpers/payments.ts","webpack://telegram-t/./src/hooks/useLayoutEffectWithPrevDeps.ts","webpack://telegram-t/./src/util/directInputManager.ts","webpack://telegram-t/./src/util/hoc/freezeWhenClosed.ts","webpack://telegram-t/./src/util/trapFocus.ts"],"sourcesContent":["import type {\n  ApiInputInvoice,\n  ApiInputSavedStarGift,\n  ApiMessage,\n  ApiRequestInputInvoice,\n  ApiRequestInputSavedStarGift,\n  ApiStarsAmount,\n  ApiStarsTransaction,\n  ApiStarsTransactionPeer,\n  ApiStarsTransactionPeerPeer,\n} from '../../api/types';\nimport type { CustomPeer } from '../../types';\nimport type { LangFn } from '../../util/localization';\nimport type { GlobalState } from '../types';\n\nimport arePropsShallowEqual from '../../util/arePropsShallowEqual';\nimport { selectChat, selectPeer, selectUser } from '../selectors';\n\nexport function getRequestInputInvoice<T extends GlobalState>(\n  global: T, inputInvoice: ApiInputInvoice,\n): ApiRequestInputInvoice | undefined {\n  if (inputInvoice.type === 'slug') return inputInvoice;\n\n  if (inputInvoice.type === 'stargiftResale') {\n    const {\n      slug,\n      peerId,\n    } = inputInvoice;\n    const peer = selectPeer(global, peerId);\n\n    if (!peer) return undefined;\n\n    return {\n      type: 'stargiftResale',\n      slug,\n      peer,\n    };\n  }\n\n  if (inputInvoice.type === 'stargift') {\n    const {\n      peerId, shouldHideName, giftId, message, shouldUpgrade,\n    } = inputInvoice;\n    const peer = selectPeer(global, peerId);\n\n    if (!peer) return undefined;\n\n    return {\n      type: 'stargift',\n      peer,\n      shouldHideName,\n      giftId,\n      message,\n      shouldUpgrade,\n    };\n  }\n\n  if (inputInvoice.type === 'starsgift') {\n    const {\n      userId, stars, amount, currency,\n    } = inputInvoice;\n    const user = selectUser(global, userId);\n\n    if (!user) return undefined;\n\n    return {\n      type: 'stars',\n      purpose: {\n        type: 'starsgift',\n        user,\n        stars,\n        amount,\n        currency,\n      },\n    };\n  }\n\n  if (inputInvoice.type === 'stars') {\n    const {\n      stars, amount, currency,\n    } = inputInvoice;\n\n    return {\n      type: 'stars',\n      purpose: {\n        type: 'stars',\n        stars,\n        amount,\n        currency,\n      },\n    };\n  }\n\n  if (inputInvoice.type === 'chatInviteSubscription') {\n    const { hash } = inputInvoice;\n\n    return {\n      type: 'chatInviteSubscription',\n      hash,\n    };\n  }\n\n  if (inputInvoice.type === 'message') {\n    const chat = selectChat(global, inputInvoice.chatId);\n    if (!chat) {\n      return undefined;\n    }\n    return {\n      type: 'message',\n      chat,\n      messageId: inputInvoice.messageId,\n    };\n  }\n\n  if (inputInvoice.type === 'premiumGiftStars') {\n    const {\n      months, userId, message,\n    } = inputInvoice;\n    const user = selectUser(global, userId);\n\n    if (!user) return undefined;\n\n    return {\n      type: 'premiumGiftStars',\n      months,\n      message,\n      user,\n    };\n  }\n\n  if (inputInvoice.type === 'giftcode') {\n    const {\n      userIds, boostChannelId, amount, currency, option, message,\n    } = inputInvoice;\n    const users = userIds.map((id) => selectUser(global, id)).filter(Boolean);\n    const boostChannel = boostChannelId ? selectChat(global, boostChannelId) : undefined;\n\n    return {\n      type: 'giveaway',\n      option,\n      purpose: {\n        type: 'giftcode',\n        amount,\n        currency,\n        users,\n        boostChannel,\n        message,\n      },\n    };\n  }\n\n  if (inputInvoice.type === 'starsgiveaway') {\n    const {\n      chatId, additionalChannelIds, amount, currency, untilDate, areWinnersVisible, countries,\n      isOnlyForNewSubscribers, prizeDescription, stars, users,\n    } = inputInvoice;\n    const chat = selectChat(global, chatId);\n    if (!chat) {\n      return undefined;\n    }\n    const additionalChannels = additionalChannelIds?.map((id) => selectChat(global, id)).filter(Boolean);\n\n    return {\n      type: 'starsgiveaway',\n      purpose: {\n        type: 'starsgiveaway',\n        amount,\n        currency,\n        chat,\n        additionalChannels,\n        untilDate,\n        areWinnersVisible,\n        countries,\n        isOnlyForNewSubscribers,\n        prizeDescription,\n        stars,\n        users,\n      },\n    };\n  }\n\n  if (inputInvoice.type === 'giveaway') {\n    const {\n      chatId, additionalChannelIds, amount, currency, option, untilDate, areWinnersVisible, countries,\n      isOnlyForNewSubscribers, prizeDescription,\n    } = inputInvoice;\n    const chat = selectChat(global, chatId);\n    if (!chat) {\n      return undefined;\n    }\n    const additionalChannels = additionalChannelIds?.map((id) => selectChat(global, id)).filter(Boolean);\n\n    return {\n      type: 'giveaway',\n      option,\n      purpose: {\n        type: 'giveaway',\n        amount,\n        currency,\n        chat,\n        additionalChannels,\n        untilDate,\n        areWinnersVisible,\n        countries,\n        isOnlyForNewSubscribers,\n        prizeDescription,\n      },\n    };\n  }\n\n  if (inputInvoice.type === 'stargiftUpgrade') {\n    const { inputSavedGift, shouldKeepOriginalDetails } = inputInvoice;\n    const savedGift = getRequestInputSavedStarGift(global, inputSavedGift);\n    if (!savedGift) return undefined;\n\n    return {\n      type: 'stargiftUpgrade',\n      inputSavedGift: savedGift,\n      shouldKeepOriginalDetails,\n    };\n  }\n\n  if (inputInvoice.type === 'stargiftTransfer') {\n    const { inputSavedGift, recipientId } = inputInvoice;\n    const savedGift = getRequestInputSavedStarGift(global, inputSavedGift);\n    const peer = selectPeer(global, recipientId);\n    if (!savedGift || !peer) return undefined;\n\n    return {\n      type: 'stargiftTransfer',\n      inputSavedGift: savedGift,\n      recipient: peer,\n    };\n  }\n\n  return undefined;\n}\n\nexport function getRequestInputSavedStarGift<T extends GlobalState>(\n  global: T, inputGift: ApiInputSavedStarGift,\n): ApiRequestInputSavedStarGift | undefined {\n  if (inputGift.type === 'user') return inputGift;\n\n  if (inputGift.type === 'chat') {\n    const chat = selectChat(global, inputGift.chatId);\n    if (!chat) return undefined;\n\n    return {\n      type: 'chat',\n      chat,\n      savedId: inputGift.savedId,\n    };\n  }\n\n  return undefined;\n}\n\nexport function buildStarsTransactionCustomPeer(\n  peer: Exclude<ApiStarsTransactionPeer, ApiStarsTransactionPeerPeer>,\n): CustomPeer {\n  if (peer.type === 'appStore') {\n    return {\n      avatarIcon: 'star',\n      isCustomPeer: true,\n      titleKey: 'Stars.Intro.Transaction.AppleTopUp.Title',\n      subtitleKey: 'Stars.Intro.Transaction.AppleTopUp.Subtitle',\n      peerColorId: 5,\n    };\n  }\n\n  if (peer.type === 'playMarket') {\n    return {\n      avatarIcon: 'star',\n      isCustomPeer: true,\n      titleKey: 'Stars.Intro.Transaction.GoogleTopUp.Title',\n      subtitleKey: 'Stars.Intro.Transaction.GoogleTopUp.Subtitle',\n      peerColorId: 3,\n    };\n  }\n\n  if (peer.type === 'fragment') {\n    return {\n      avatarIcon: 'star',\n      isCustomPeer: true,\n      titleKey: 'Stars.Intro.Transaction.FragmentTopUp.Title',\n      subtitleKey: 'Stars.Intro.Transaction.FragmentTopUp.Subtitle',\n      customPeerAvatarColor: '#000000',\n    };\n  }\n\n  if (peer.type === 'premiumBot') {\n    return {\n      avatarIcon: 'star',\n      isCustomPeer: true,\n      titleKey: 'Stars.Intro.Transaction.PremiumBotTopUp.Title',\n      subtitleKey: 'Stars.Intro.Transaction.PremiumBotTopUp.Subtitle',\n      peerColorId: 1,\n      withPremiumGradient: true,\n    };\n  }\n\n  if (peer.type === 'ads') {\n    return {\n      avatarIcon: 'star',\n      isCustomPeer: true,\n      titleKey: 'Stars.Intro.Transaction.TelegramAds.Title',\n      subtitleKey: 'Stars.Intro.Transaction.TelegramAds.Subtitle',\n      peerColorId: 2,\n    };\n  }\n\n  if (peer.type === 'api') {\n    return {\n      avatarIcon: 'bots',\n      isCustomPeer: true,\n      titleKey: 'Stars.Intro.Transaction.TelegramBotApi.Title',\n      subtitleKey: 'Stars.Intro.Transaction.TelegramBotApi.Subtitle',\n      peerColorId: 4,\n    };\n  }\n\n  return {\n    avatarIcon: 'star',\n    isCustomPeer: true,\n    titleKey: 'Stars.Intro.Transaction.Unsupported.Title',\n    subtitleKey: 'Stars.Intro.Transaction.Unsupported.Title',\n    peerColorId: 0,\n  };\n}\n\nexport function formatStarsTransactionAmount(lang: LangFn, starsAmount: ApiStarsAmount) {\n  const amount = starsAmount.amount + starsAmount.nanos / 1e9;\n  if (amount < 0) {\n    return `- ${lang.number(Math.abs(amount))}`;\n  }\n\n  return `+ ${lang.number(amount)}`;\n}\n\nexport function formatStarsAmount(lang: LangFn, starsAmount: ApiStarsAmount) {\n  return lang.number(starsAmount.amount + starsAmount.nanos / 1e9);\n}\n\nexport function getStarsTransactionFromGift(message: ApiMessage): ApiStarsTransaction | undefined {\n  const { action } = message.content;\n\n  if (action?.type !== 'giftStars') return undefined;\n\n  const { transactionId, stars } = action;\n\n  return {\n    id: transactionId,\n    stars: {\n      amount: stars,\n      nanos: 0,\n    },\n    peer: {\n      type: 'peer',\n      id: message.isOutgoing ? message.chatId : (message.senderId || message.chatId),\n    },\n    date: message.date,\n    isGift: true,\n    isMyGift: message.isOutgoing || undefined,\n  };\n}\n\nexport function getPrizeStarsTransactionFromGiveaway(message: ApiMessage): ApiStarsTransaction | undefined {\n  const { action } = message.content;\n\n  if (action?.type !== 'prizeStars') return undefined;\n\n  const { transactionId, stars, boostPeerId } = action;\n\n  return {\n    id: transactionId,\n    stars: {\n      amount: stars,\n      nanos: 0,\n    },\n    peer: {\n      type: 'peer',\n      id: boostPeerId,\n    },\n    date: message.date,\n    giveawayPostId: message.id,\n  };\n}\n\nexport function areInputSavedGiftsEqual(one: ApiInputSavedStarGift, two: ApiInputSavedStarGift) {\n  return arePropsShallowEqual(one, two);\n}\n","import { useLayoutEffect, useRef } from '../lib/teact/teact';\n\nconst useLayoutEffectWithPrevDeps = <const T extends readonly any[]>(\n  cb: (args: T | readonly []) => void, dependencies: T, debugKey?: string,\n) => {\n  const prevDepsRef = useRef<T>();\n\n  return useLayoutEffect(() => {\n    const prevDeps = prevDepsRef.current;\n    prevDepsRef.current = dependencies;\n\n    return cb(prevDeps || []);\n    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, dependencies, debugKey);\n};\n\nexport default useLayoutEffectWithPrevDeps;\n","let counter = 0;\n\nexport function disableDirectTextInput() {\n  counter += 1;\n}\n\nexport function enableDirectTextInput() {\n  counter -= 1;\n}\n\nexport function getIsDirectTextInputDisabled() {\n  return counter > 0;\n}\n","import { type FC, type Props, useRef } from '../../lib/teact/teact';\n\ntype InjectProps<T extends FC, P extends Props> = FC<Parameters<T>[0] & P>;\n\ntype OwnProps = {\n  ignoreFreeze?: boolean;\n};\n\nexport default function freezeWhenClosed<T extends FC>(Component: T): InjectProps<T, OwnProps> {\n  function ComponentWrapper(props: Props) {\n    const newProps = useRef(props);\n\n    if (props.ignoreFreeze) return Component(props);\n\n    if (props.isOpen) {\n      newProps.current = props;\n    } else {\n      newProps.current = {\n        ...newProps.current,\n        isOpen: false,\n      };\n    }\n\n    return Component(newProps.current);\n  }\n\n  return ComponentWrapper as T;\n}\n","export default function trapFocus(element: HTMLElement) {\n  function handleKeyDown(e: KeyboardEvent) {\n    if (e.key !== 'Tab') {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    const focusableElements = Array.from(\n      element.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'),\n    ) as HTMLElement[];\n    if (!focusableElements.length) {\n      return;\n    }\n\n    const currentFocusedIndex = focusableElements.findIndex((em) => em.isSameNode(document.activeElement));\n    let newFocusedIndex = 0;\n    if (currentFocusedIndex >= 0) {\n      if (e.shiftKey) {\n        newFocusedIndex = currentFocusedIndex > 0\n          ? currentFocusedIndex - 1\n          : focusableElements.length - 1;\n      } else {\n        newFocusedIndex = currentFocusedIndex < focusableElements.length - 1\n          ? currentFocusedIndex + 1\n          : 0;\n      }\n    }\n\n    focusableElements[newFocusedIndex].focus();\n  }\n\n  document.addEventListener('keydown', handleKeyDown, false);\n\n  return () => {\n    document.removeEventListener('keydown', handleKeyDown, false);\n  };\n}\n"],"names":["arePropsShallowEqual","selectChat","selectPeer","selectUser","getRequestInputInvoice","global","inputInvoice","type","slug","peerId","peer","undefined","shouldHideName","giftId","message","shouldUpgrade","userId","stars","amount","currency","user","purpose","hash","chat","chatId","messageId","months","userIds","boostChannelId","option","users","map","id","filter","Boolean","boostChannel","additionalChannelIds","untilDate","areWinnersVisible","countries","isOnlyForNewSubscribers","prizeDescription","additionalChannels","inputSavedGift","shouldKeepOriginalDetails","savedGift","getRequestInputSavedStarGift","recipientId","recipient","inputGift","savedId","buildStarsTransactionCustomPeer","avatarIcon","isCustomPeer","titleKey","subtitleKey","peerColorId","customPeerAvatarColor","withPremiumGradient","formatStarsTransactionAmount","lang","starsAmount","nanos","number","Math","abs","formatStarsAmount","getStarsTransactionFromGift","action","content","transactionId","isOutgoing","senderId","date","isGift","isMyGift","getPrizeStarsTransactionFromGiveaway","boostPeerId","giveawayPostId","areInputSavedGiftsEqual","one","two","useLayoutEffect","useRef","useLayoutEffectWithPrevDeps","cb","dependencies","debugKey","prevDepsRef","prevDeps","current","counter","disableDirectTextInput","enableDirectTextInput","getIsDirectTextInputDisabled","freezeWhenClosed","Component","ComponentWrapper","props","newProps","ignoreFreeze","isOpen","trapFocus","element","handleKeyDown","e","key","preventDefault","stopPropagation","focusableElements","Array","from","querySelectorAll","length","currentFocusedIndex","findIndex","em","isSameNode","document","activeElement","newFocusedIndex","shiftKey","focus","addEventListener","removeEventListener"],"sourceRoot":""}