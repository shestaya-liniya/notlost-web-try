{"version":3,"file":"src_global_shared_sharedState_worker_ts.4bb372383202a7aa95ff.js","mappings":"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","sources":["webpack://telegram-t/./src/util/data/freeze.ts","webpack://telegram-t/./src/util/deepDiff.ts","webpack://telegram-t/./src/util/deepMerge.ts","webpack://telegram-t/./src/util/iteratees.ts","webpack://telegram-t/webpack/bootstrap","webpack://telegram-t/webpack/runtime/define property getters","webpack://telegram-t/webpack/runtime/hasOwnProperty shorthand","webpack://telegram-t/webpack/runtime/make namespace object","webpack://telegram-t/./src/global/shared/sharedState.worker.ts"],"sourcesContent":["export function deepFreeze<T extends object | undefined>(o: T) {\n  if (!o) return o;\n  Object.values(o).forEach((v) => Object.isFrozen(v) || deepFreeze(v));\n  return Object.freeze(o);\n}\n","import { isLiteralObject, unique } from './iteratees';\n\nconst EQUAL = Symbol('EQUAL');\nconst DELETE = { __delete: true };\nconst DELETE_ALL_CHILDREN = { __deleteAllChildren: true };\n\ntype NestedDiff<T> = T extends object\n  ? { [K in keyof T]?: NestedDiff<T[K]> | typeof DELETE_ALL_CHILDREN | typeof DELETE | null } : T;\n\nexport type DiffObject<T> = T extends object\n  ? { [K in keyof T]?: NestedDiff<T[K]> } | typeof DELETE_ALL_CHILDREN\n  : T;\n\nexport function deepDiff<T extends any>(value1: T, value2: T): Partial<T> | typeof EQUAL | typeof DELETE_ALL_CHILDREN {\n  if (value1 === value2) {\n    return EQUAL;\n  }\n\n  const type1 = typeof value1;\n  const type2 = typeof value2;\n\n  if (type1 !== type2) {\n    return value2;\n  }\n\n  if (Array.isArray(value1) && Array.isArray(value2) && areSortedArraysDeepEqual(value1, value2)) {\n    return EQUAL;\n  }\n\n  if (!isLiteralObject(value1) || !isLiteralObject(value2)) {\n    return value2;\n  }\n\n  const object1 = value1 as AnyLiteral;\n  const object2 = value2 as AnyLiteral;\n  const keys1 = Object.keys(object1);\n  const keys2 = Object.keys(object2);\n\n  if (!keys2.length) {\n    return !keys1.length ? EQUAL : DELETE_ALL_CHILDREN;\n  }\n\n  const allKeys = unique(keys1.concat(keys2));\n\n  const diff = allKeys.reduce((acc: any, key) => {\n    const subValue1 = object1[key];\n    const subValue2 = object2[key];\n\n    if (!object2.hasOwnProperty(key)) {\n      acc[key] = DELETE;\n      return acc;\n    }\n\n    if (!object1!.hasOwnProperty(key)) {\n      acc[key] = subValue2;\n      return acc;\n    }\n\n    const subDiff = deepDiff(subValue1, subValue2);\n    if (subDiff !== EQUAL) {\n      acc[key] = subDiff;\n    }\n\n    return acc;\n  }, {});\n\n  if (Object.keys(diff).length === 0) {\n    return EQUAL;\n  }\n\n  return diff;\n}\n\nfunction areSortedArraysDeepEqual<T extends Array<any>>(array1: T, array2: T) {\n  if (array1.length !== array2.length) {\n    return false;\n  }\n\n  return array1.every((item, i) => deepDiff(item, array2[i]) === EQUAL);\n}\n","import type { DiffObject } from './deepDiff';\n\nimport { isLiteralObject, unique } from './iteratees';\n\nexport function deepMerge<T extends object>(value1: T, value2: DiffObject<T>): T {\n  if (value1 === value2) {\n    return value2 as unknown as T;\n  }\n\n  if (!isLiteralObject(value2)) {\n    return value2;\n  }\n\n  if (!isLiteralObject(value1)) {\n    return reduceDiff(value2) as T;\n  }\n\n  // eslint-disable-next-line no-underscore-dangle\n  if ('__deleteAllChildren' in value2) {\n    return {} as T;\n  }\n\n  const allKeys = unique(Object.keys(value1).concat(Object.keys(value2)));\n\n  return allKeys.reduce((acc: AnyLiteral, key) => {\n    const oldValue = (value1 as AnyLiteral)[key];\n\n    if (!value2.hasOwnProperty(key)) {\n      acc[key] = oldValue;\n    } else {\n      const newValue = (value2 as AnyLiteral)[key];\n      // eslint-disable-next-line no-underscore-dangle\n      if (!newValue?.__delete) {\n        acc[key] = deepMerge(oldValue, newValue);\n      }\n    }\n\n    return acc;\n  }, {}) as T;\n}\n\nfunction reduceDiff(diff: AnyLiteral) {\n  // eslint-disable-next-line no-underscore-dangle\n  if (diff.__deleteAllChildren) {\n    return {};\n  }\n\n  return Object.entries(diff).reduce((acc: AnyLiteral, [key, value]) => {\n    // eslint-disable-next-line no-underscore-dangle\n    if (!value?.__delete) {\n      // eslint-disable-next-line no-null/no-null\n      acc[key] = isLiteralObject(value) ? reduceDiff(value) : value;\n    }\n\n    return acc;\n  }, {});\n}\n","type CollectionByKey<Member> = Record<number | string, Member>;\n\ntype OrderDirection =\n  'asc'\n  | 'desc';\n\ninterface OrderCallback<T> {\n  (member: T): any;\n}\n\nexport function buildCollectionByKey<T extends AnyLiteral>(collection: T[], key: keyof T) {\n  return collection.reduce((byKey: CollectionByKey<T>, member: T) => {\n    byKey[member[key]] = member;\n\n    return byKey;\n  }, {});\n}\n\nexport function buildCollectionByCallback<T extends AnyLiteral, K extends number | string, R extends unknown>(\n  collection: T[],\n  callback: (member: T) => [K, R],\n) {\n  return collection.reduce((byKey: Record<K, R>, member: T) => {\n    const [key, value] = callback(member);\n    byKey[key] = value;\n\n    return byKey;\n  }, {} as Record<K, R>);\n}\n\nexport function mapValues<R extends any, M extends any>(\n  byKey: CollectionByKey<M>,\n  callback: (member: M, key: string, index: number, originalByKey: CollectionByKey<M>) => R,\n): CollectionByKey<R> {\n  return Object.keys(byKey).reduce((newByKey: CollectionByKey<R>, key, index) => {\n    newByKey[key] = callback(byKey[key], key, index, byKey);\n    return newByKey;\n  }, {});\n}\n\nexport function pick<T, K extends keyof T>(object: T, keys: K[]) {\n  return keys.reduce((result, key) => {\n    result[key] = object[key];\n    return result;\n  }, {} as Pick<T, K>);\n}\n\nexport function pickTruthy<T, K extends keyof T>(object: T, keys: K[]) {\n  return keys.reduce((result, key) => {\n    if (object[key]) {\n      result[key] = object[key];\n    }\n\n    return result;\n  }, {} as Pick<T, K>);\n}\n\nexport function omit<T extends object, K extends keyof T>(object: T, keys: K[]): Omit<T, K> {\n  const stringKeys = new Set(keys.map(String));\n  const savedKeys = Object.keys(object)\n    .filter((key) => !stringKeys.has(key)) as Array<Exclude<keyof T, K>>;\n\n  return pick(object, savedKeys);\n}\n\nexport function omitUndefined<T extends object>(object: T): T {\n  return Object.keys(object).reduce((result, stringKey) => {\n    const key = stringKey as keyof T;\n    if (object[key] !== undefined) {\n      result[key as keyof T] = object[key];\n    }\n    return result;\n  }, {} as T);\n}\n\nexport function orderBy<T>(\n  collection: T[],\n  orderRule: (keyof T) | OrderCallback<T> | ((keyof T) | OrderCallback<T>)[],\n  mode: OrderDirection | [OrderDirection, OrderDirection] = 'asc',\n): T[] {\n  function compareValues(a: T, b: T, currentOrderRule: (keyof T) | OrderCallback<T>, isAsc: boolean) {\n    const aValue = (typeof currentOrderRule === 'function' ? currentOrderRule(a) : a[currentOrderRule]) || 0;\n    const bValue = (typeof currentOrderRule === 'function' ? currentOrderRule(b) : b[currentOrderRule]) || 0;\n\n    return isAsc ? aValue - bValue : bValue - aValue;\n  }\n\n  if (Array.isArray(orderRule)) {\n    const [mode1, mode2] = Array.isArray(mode) ? mode : [mode, mode];\n    const [orderRule1, orderRule2] = orderRule;\n    const isAsc1 = mode1 === 'asc';\n    const isAsc2 = mode2 === 'asc';\n\n    return collection.sort((a, b) => {\n      return compareValues(a, b, orderRule1, isAsc1) || compareValues(a, b, orderRule2, isAsc2);\n    });\n  }\n\n  const isAsc = mode === 'asc';\n  return collection.sort((a, b) => {\n    return compareValues(a, b, orderRule, isAsc);\n  });\n}\n\nexport function unique<T extends any>(array: T[]): T[] {\n  return Array.from(new Set(array));\n}\n\nexport function uniqueByField<T extends any>(array: T[], field: keyof T): T[] {\n  return [...new Map(array.map((item) => [item[field], item])).values()];\n}\n\nexport function compact<T extends any>(array: T[]) {\n  return array.filter(Boolean);\n}\n\nexport function areSortedArraysEqual(array1: any[], array2: any[]) {\n  if (array1.length !== array2.length) {\n    return false;\n  }\n\n  return array1.every((item, i) => item === array2[i]);\n}\n\nexport function areSortedArraysIntersecting(array1: any[], array2: any[]) {\n  return array1[0] <= array2[array2.length - 1] && array1[array1.length - 1] >= array2[0];\n}\nexport function isInsideSortedArrayRange(value:any, array: any[]) {\n  return array[0] <= value && value <= array[array.length - 1];\n}\n\nexport function findIntersectionWithSet<T>(array: T[], set: Set<T>): T[] {\n  return array.filter((a) => set.has(a));\n}\n/**\n * Exlude elements from base array. Both arrays should be sorted in same order\n * @param base\n * @param toExclude\n * @returns New array without excluded elements\n */\nexport function excludeSortedArray<T extends any>(base: T[], toExclude: T[]) {\n  if (!base?.length) return base;\n\n  const result: T[] = [];\n\n  let excludeIndex = 0;\n\n  for (let i = 0; i < base.length; i++) {\n    if (toExclude[excludeIndex] === base[i]) {\n      excludeIndex += 1;\n    } else {\n      result.push(base[i]);\n    }\n  }\n\n  return result;\n}\n\nexport function split<T extends any>(array: T[], chunkSize: number) {\n  const result: T[][] = [];\n  for (let i = 0; i < array.length; i += chunkSize) {\n    result.push(array.slice(i, i + chunkSize));\n  }\n\n  return result;\n}\n\nexport function partition<T extends unknown>(\n  array: T[], filter: (value: T, index: number, array: T[]) => boolean | undefined,\n): [T[], T[]] {\n  const pass: T[] = [];\n  const fail: T[] = [];\n\n  array.forEach((e, idx, arr) => (filter(e, idx, arr) ? pass : fail).push(e));\n\n  return [pass, fail];\n}\n\nexport function cloneDeep<T>(value: T): T {\n  if (!isObject(value)) {\n    return value;\n  }\n\n  if (Array.isArray(value)) {\n    return value.map(cloneDeep) as typeof value;\n  }\n\n  return Object.keys(value).reduce((acc, key) => {\n    acc[key as keyof T] = cloneDeep(value[key as keyof T]);\n    return acc;\n  }, {} as T);\n}\n\nexport function isLiteralObject(value: any): value is AnyLiteral {\n  return isObject(value) && !Array.isArray(value);\n}\n\nfunction isObject(value: any): value is object {\n  // eslint-disable-next-line no-null/no-null\n  return typeof value === 'object' && value !== null;\n}\n\nexport function findLast<T>(array: Array<T>, predicate: (value: T, index: number, obj: T[]) => boolean): T | undefined {\n  let cursor = array.length;\n\n  while (cursor--) {\n    if (predicate(array[cursor], cursor, array)) {\n      return array[cursor];\n    }\n  }\n\n  return undefined;\n}\n\nexport function compareFields<T>(a: T, b: T) {\n  return Number(b) - Number(a);\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import type { SharedState } from '../types';\nimport type { WorkerBoundMessageEvent } from './sharedStateConnector';\n\nimport { deepFreeze } from '../../util/data/freeze';\nimport { deepDiff, type DiffObject } from '../../util/deepDiff';\nimport { deepMerge } from '../../util/deepMerge';\n\ndeclare const self: SharedWorkerGlobalScope;\n\ninterface StateUpdateEvent {\n  type: 'stateUpdate';\n  update: DiffObject<SharedState>;\n}\n\ninterface FullStateEvent {\n  type: 'fullState';\n  state: SharedState;\n}\n\nexport type ClientBoundMessageEvent = StateUpdateEvent | FullStateEvent;\n\nlet state: SharedState | undefined;\n\nconst ports: MessagePort[] = [];\n\nself.onconnect = (e: MessageEvent) => {\n  const port = e.ports[0];\n  ports.push(port);\n  port.start();\n\n  port.onmessage = (event: MessageEvent<WorkerBoundMessageEvent>) => {\n    const data = event.data;\n    switch (data.type) {\n      case 'reqGetFullState': {\n        const localState = data.localState;\n        if (!state) {\n          // First tab to load, use this state as the source of truth.\n          state = localState;\n        }\n        sendToClient(port, { type: 'fullState', state });\n        break;\n      }\n\n      case 'reqUpdateState': {\n        if (!state) return; // Client should request full state first\n        const prevState = state;\n        state = deepMerge(state, data.update as SharedState);\n        state.isInitial = undefined; // Remove the flag\n\n        const diff = deepDiff(prevState, state);\n        if (typeof diff !== 'symbol') {\n          broadcast({ type: 'stateUpdate', update: diff }, port);\n        }\n        break;\n      }\n    }\n  };\n};\n\nfunction sendToClient(port: MessagePort, message: ClientBoundMessageEvent) {\n  port.postMessage(message);\n}\n\nfunction broadcast(message: ClientBoundMessageEvent, ignorePort?: MessagePort) {\n  // Iterate backwards to safely remove ports if needed.\n  for (let i = ports.length - 1; i >= 0; i--) {\n    if (ports[i] === ignorePort) { // Prevent infinite loopback\n      continue;\n    }\n\n    try {\n      sendToClient(ports[i], message);\n    } catch (e) {\n      ports.splice(i, 1);\n    }\n  }\n}\n\n// DEBUG\n(self as any).getState = () => deepFreeze(state);\n"],"names":["deepFreeze","o","Object","values","forEach","v","isFrozen","freeze","isLiteralObject","unique","EQUAL","Symbol","DELETE","__delete","DELETE_ALL_CHILDREN","__deleteAllChildren","deepDiff","value1","value2","type1","type2","Array","isArray","areSortedArraysDeepEqual","object1","object2","keys1","keys","keys2","length","allKeys","concat","diff","reduce","acc","key","subValue1","subValue2","hasOwnProperty","subDiff","array1","array2","every","item","i","deepMerge","reduceDiff","oldValue","newValue","entries","value","buildCollectionByKey","collection","byKey","member","buildCollectionByCallback","callback","mapValues","newByKey","index","pick","object","result","pickTruthy","omit","stringKeys","Set","map","String","savedKeys","filter","has","omitUndefined","stringKey","undefined","orderBy","orderRule","mode","compareValues","a","b","currentOrderRule","isAsc","aValue","bValue","mode1","mode2","orderRule1","orderRule2","isAsc1","isAsc2","sort","array","from","uniqueByField","field","Map","compact","Boolean","areSortedArraysEqual","areSortedArraysIntersecting","isInsideSortedArrayRange","findIntersectionWithSet","set","excludeSortedArray","base","toExclude","excludeIndex","push","split","chunkSize","slice","partition","pass","fail","e","idx","arr","cloneDeep","isObject","findLast","predicate","cursor","compareFields","Number","state","ports","self","onconnect","port","start","onmessage","event","data","type","localState","sendToClient","prevState","update","isInitial","broadcast","message","postMessage","ignorePort","splice","getState"],"sourceRoot":""}